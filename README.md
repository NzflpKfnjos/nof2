æç¤ºè¯å¿…é¡»è‡ªå·±é‡å†™ï¼ŒåŸºç¡€ä»£ç æ˜¯æä¾›å­¦ä¹ é­”æ”¹ã€‚

æ–°å¢åŠ äº†æ­¢ç›ˆæ­¢æŸæ¡ä»¶å•
åŠ¨æ€è°ƒæ•´æ­¢ç›ˆæ­¢æŸ
åæ‰‹å¼€å•

å…¶å®ƒå¼€å•é‡‘é¢,æ æ†è®¾ç½®éƒ½åœ¨æç¤ºè¯prompt.txtæ–‡ä»¶

ğŸ’° è´¦æˆ·èµ„é‡‘è®¡ç®—è§„åˆ™
**é‡è¦**ï¼š`position_size` æ˜¯**è´¦æˆ·æ€»æƒç›Š**ã€‚

**è®¡ç®—æ­¥éª¤**ï¼š
1. **è´¦æˆ·æ€»æƒç›Š** = è´¦æˆ·ä½™é¢ + å½“å‰æœªå®ç°ç›ˆäº
2. **åä¹‰ä»·å€¼** = è´¦æˆ·æ€»æƒç›Š Ã— 2
3. **position_size** = åä¹‰ä»·å€¼ï¼ˆJSONä¸­å¡«å†™æ­¤å€¼ï¼‰
4. **å®é™…å¼€å•é‡‘é¢** = position_size

**ç¤ºä¾‹**ï¼šè´¦æˆ·æ€»æƒç›Š $500ï¼Œæ æ† 2x
- è´¦æˆ·æ€»æƒç›Š = $500
- position_size = $500 Ã— 2 = **$1000** â† JSONå¡«æ­¤å€¼

å¼€ä»“æ æ†é™åˆ¶ï¼š
- BTC/ETH ä¸»æµå¸ç§æœ€å°æ æ†ä¸‹é™:5x æœ€å¤§æ æ†ä¸Šé™æ˜¯10x
- å…¶å®ƒå±±å¯¨å¸ç§æœ€å°æ æ†ä¸‹é™:1x æœ€å¤§æ æ†ä¸Šé™æ˜¯3x

é‡ç‚¹:è¿™éƒ¨åˆ†å†…å®¹ä¸€å®šä¸èƒ½åˆ é™¤,å…¶å®ƒçš„éšä¾¿æ”¹.

è¡¨å•è¦ä¿®æ”¹é…ç½®æ–‡ä»¶config.pyå¡«å…¥æ‚¨çš„å¸å®‰å…¬ç§é’¥å°±å¯ä»¥äº†

æ‰‹æœºå®‰è£…æ‰€éœ€è¦çš„åº“ï¼Œå…¶ä»–ä¸æ‡‚çš„å°±é—®ai

è‡ªå·±å»ç ”ç©¶å§

pip install -r requirements.txt

å¯åŠ¨:python3 main.py

å¯åŠ¨å‰ç«¯:python3 api_history.py

å‰ç«¯è®¿é—®åœ°å€ï¼šhttp://127.0.0.1:8600

---

## æŒä»“ç›‘æ§ï¼ˆget_main.pyï¼‰

`get_main.py` ç”¨äº**å®æ—¶æŸ¥çœ‹å¸å®‰åˆçº¦æŒä»“**ï¼šæ ‡è®°ä»·ã€å¼€ä»“ä»·ã€æœªå®ç°ç›ˆäºã€æ”¶ç›Šç‡ã€æ æ†ã€æ–¹å‘ï¼ˆåšå¤š/åšç©ºï¼‰ã€å½“å‰æ­¢æŸä»·ï¼Œå¹¶æ”¯æŒâ€œ**è‡ªåŠ¨æŠŠæ­¢æŸä»·ä¸€æ­¥ä¸€æ­¥æ¨åˆ°ä¸¤å¹³ä»·ï¼ˆä¿æœ¬ä»·ï¼‰**â€ã€‚

### 1ï¼‰å‡†å¤‡

- éœ€è¦å¸å®‰ API Key/Secretï¼ˆåˆçº¦æƒé™ï¼‰ã€‚
- è¯»å–ä¼˜å…ˆçº§ï¼šç¯å¢ƒå˜é‡ `BINANCE_API_KEY` / `BINANCE_API_SECRET` â†’ `config.py`

### 2ï¼‰åŸºç¡€ç”¨æ³•ï¼ˆåªæŸ¥çœ‹ï¼‰

```bash
python get_main.py
```

å¸¸ç”¨å‚æ•°ï¼š

```bash
# æ¯ 2 ç§’åˆ·æ–°ä¸€æ¬¡
python get_main.py --interval 2

# åªè·å–ä¸€æ¬¡å°±é€€å‡º
python get_main.py --once

# åªçœ‹æŒ‡å®šäº¤æ˜“å¯¹
python get_main.py --symbols BASUSDT,BTCUSDT

# ä¸æ¸…å±ï¼ˆé€‚åˆæ—¥å¿—/æ’æŸ¥ï¼‰
python get_main.py --no-clear
```

### 3ï¼‰è‡ªåŠ¨æ­¢æŸï¼šé€æ­¥æ¨åˆ°ä¸¤å¹³ä»·ï¼ˆå®ç›˜ä¼šæ’¤å•+ä¸‹å•ï¼‰

> âš  æ³¨æ„ï¼šå¼€å¯åä¼šçœŸå®æ“ä½œä½ çš„è´¦æˆ·ï¼ˆæ’¤é”€å·²æœ‰æ­¢æŸå•å¹¶é‡æ–°ä¸‹ `STOP_MARKET(closePosition=True)`ï¼‰ã€‚ä¸ç¡®å®šå°±å…ˆç”¨ `--sl-dry-run` æ¨¡æ‹Ÿã€‚

```bash
# åªæ¨¡æ‹Ÿï¼Œä¸çœŸå®æ’¤å•/ä¸‹å•ï¼ˆæ¨èå…ˆè·‘è¿™ä¸ªç¡®è®¤è¡Œä¸ºï¼‰
python get_main.py --auto-sl --sl-dry-run --sl-verbose --no-clear

# å®ç›˜è‡ªåŠ¨æ¨è¿›æ­¢æŸåˆ°ä¸¤å¹³ä»·
python get_main.py --auto-sl
```

è¡Œä¸ºè¯´æ˜ï¼š

- ä¸¤å¹³ä»·ï¼ˆä¿æœ¬ä»·ï¼‰å½“å‰æŒ‰**å¼€ä»“ä»· entry** è®¡ç®—ã€‚
- é»˜è®¤æ¨¡å¼æ˜¯ `--sl-mode lock_profit`ï¼šç›ˆåˆ©æ—¶æ­¢æŸ**è‡³å°‘åˆ°å¼€ä»“ä»·**ï¼Œå¹¶æŒ‰ç…§ `--sl-trail-pct` éšä»·æ ¼ä¸Šç§»/ä¸‹ç§»ï¼Œç”¨äº**é”å®šåˆ©æ¶¦**ã€‚
- å¯åˆ‡å› `--sl-mode breakeven`ï¼šåªæŠŠæ­¢æŸé€æ­¥æ¨åˆ°ä¸¤å¹³ä»·ï¼ˆä¸é¢å¤–é”ç›ˆï¼‰ã€‚
- **åšå¤š**ï¼šåªæœ‰å½“ `æ ‡è®°ä»· >= ä¸¤å¹³ä»·`ï¼ˆå¹¶ç•™å‡º `--sl-buffer-ticks` çš„å®‰å…¨è·ç¦»ï¼‰æ‰ä¼šå¼€å§‹æ¨è¿›ï¼›å¦åˆ™æŠŠæ­¢æŸè®¾åˆ°ä¸¤å¹³ä»·ä¼š**ç«‹å³è§¦å‘**ã€‚
- **åšç©º**ï¼šåªæœ‰å½“ `æ ‡è®°ä»· <= ä¸¤å¹³ä»·`ï¼ˆå¹¶ç•™å‡ºå®‰å…¨è·ç¦»ï¼‰æ‰ä¼šå¼€å§‹æ¨è¿›ã€‚
- â€œä¸€æ­¥ä¸€æ­¥â€æ¨¡å¼ä¸‹ç”± `--sl-step-pct` æ§åˆ¶ï¼ˆæ¯æ¬¡æ¨è¿›çš„æ­¥é•¿ï¼Œä¸”ä¸ä¼šå°äº tickSizeï¼‰ã€‚
- ä¸ºé¿å…é¢‘ç¹æ”¹å•ï¼Œ`--sl-min-interval` é™åˆ¶åŒä¸€åˆçº¦åŒä¸€æ–¹å‘çš„æœ€å°æ›´æ–°é—´éš”ã€‚

å‚æ•°å‚è€ƒï¼š

```bash
# æ¯æ¬¡æ¨è¿› 0.10%ï¼ˆæ›´å¿«ï¼‰ï¼Œæ¯ 10 ç§’æœ€å¤šæ›´æ–°ä¸€æ¬¡ï¼Œæ­¢æŸä¸æ ‡è®°ä»·è‡³å°‘é—´éš” 3 ä¸ª tick
python get_main.py --auto-sl --sl-step-pct 0.10 --sl-min-interval 10 --sl-buffer-ticks 3

# é”ç›ˆæ¨¡å¼ï¼šå›æ’¤ 0.5% è§¦å‘æ­¢æŸï¼ˆè¶Šå°è¶Šè´´è¿‘ï¼Œè¶Šå®¹æ˜“è¢«æ‰«ï¼‰
python get_main.py --auto-sl --sl-mode lock_profit --sl-trail-pct 0.5

# é”ç›ˆæ¨¡å¼ï¼šæµ®ç›ˆè¾¾åˆ° 0.5% æ‰å¼€å§‹æ¨æ­¢æŸï¼ˆé»˜è®¤ 0.5%ï¼‰
python get_main.py --auto-sl --sl-mode lock_profit --sl-activate-profit-pct 0.5

# åªæ¨ä¸¤å¹³ï¼ˆä¸é”ç›ˆï¼‰
python get_main.py --auto-sl --sl-mode breakeven

# æ­¢æŸ/æŒ‚å•ä¿¡æ¯æ¯ 10 ç§’åˆ·æ–°ä¸€æ¬¡ï¼ˆæ›´çœè¯·æ±‚ï¼Œé™ä½è§¦å‘ -1003 çš„æ¦‚ç‡ï¼‰
python get_main.py --sl-refresh 10

# å°†â€œæ­¢æŸè®¾ç½®/æ’¤å•/ä¸‹å•â€çš„è®°å½•è¿½åŠ å†™å…¥æ–‡ä»¶ï¼Œæ–¹ä¾¿å›çœ‹
python get_main.py --auto-sl --sl-log-file sl.log
```

### 3.1ï¼‰ç”¨ Docker éƒ¨ç½² get_main.pyï¼ˆé»˜è®¤è¯»å– config.pyï¼‰

1ï¼‰ç¡®ä¿ `config.py` å·²å¡«å†™å¸å®‰ Key/Secretï¼ˆå’Œæœ¬åœ°è¿è¡Œä¸€è‡´ï¼‰ã€‚

2ï¼‰å¯åŠ¨æŒä»“ç›‘æ§å®¹å™¨ï¼ˆ`get-main` é»˜è®¤æ‰§è¡Œï¼š`python get_main.py --auto-sl`ï¼Œä¸”é”ç›ˆè§¦å‘é˜ˆå€¼é»˜è®¤ 0.5%ï¼‰ï¼š

```bash
docker compose up -d --build get-main
```

3ï¼‰æŸ¥çœ‹å®æ—¶æ—¥å¿—ï¼š

```bash
docker logs -f nofx-get-main
```

> æ³¨æ„ï¼š`get-main` é»˜è®¤å¸¦ `--auto-sl` ä¼šçœŸå®æ’¤å•+ä¸‹æ­¢æŸå•ï¼›å¦‚æœä½ åªæƒ³æŸ¥çœ‹ï¼ŒæŠŠ `docker-compose.yml` é‡Œ `get-main` çš„ `command` å»æ‰ `--auto-sl` æˆ–æ”¹æˆ `--sl-dry-run`ã€‚

### 4ï¼‰å…³äº -1003 Too many requestsï¼ˆé¢‘ç‡é™åˆ¶ï¼‰

å¦‚æœçœ‹åˆ°ï¼š`APIError(code=-1003): Too many requests...`

- è¯´æ˜åŒä¸€ IP ä¸‹è¯·æ±‚è¿‡äºé¢‘ç¹ï¼ˆæˆ–åŒæ—¶è·‘äº†å¤šä¸ªè½®è¯¢è„šæœ¬ï¼‰ã€‚
- å»ºè®®æŠŠ `--interval` / `--sl-refresh` è°ƒå¤§ï¼Œæˆ–è€…å‡å°‘åŒ IP ä¸‹åŒæ—¶è¿è¡Œçš„ç¨‹åºã€‚
- æ›´ç†æƒ³çš„å®æ—¶æ–¹æ¡ˆæ˜¯ä½¿ç”¨ websocketï¼ˆé¿å…é«˜é¢‘è½®è¯¢ï¼‰ã€‚

docker rm -f
docker rmi -f
docker logs -f nofx

docker compose up -d --build


<img width="1918" height="903" alt="image" src="https://github.com/user-attachments/assets/0824bffa-b8c3-4f63-add3-acff1725dba9" />

<img width="1918" height="903" alt="image" src="https://github.com/user-attachments/assets/728faf5f-2767-4303-905a-f52dcf46b905" />

<img width="1918" height="903" alt="image" src="https://github.com/user-attachments/assets/9f1c88d1-c787-482c-9016-69ebf0b468ce" />

<img width="1918" height="903" alt="image" src="https://github.com/user-attachments/assets/70422b46-50ff-4477-badd-ec932f943837" />
